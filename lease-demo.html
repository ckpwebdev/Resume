<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lease Agreement Demo | Christopher Pink</title>

  <!-- Site styles (same as the rest of your site) -->
  <link rel="stylesheet" href="styles.css" />

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- Small page-only tweaks that reuse your CSS variables -->
  <style>
    /* Single-column layout: form above preview */
    .lease-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.75rem;
      align-items: start;
      margin-top: 1.5rem;
    }

    /* Demo warning banner (matches nda-generator.html) */
    .demo-warning {
      border: 1px solid rgba(56, 189, 248, 0.35);
      background: rgba(56, 189, 248, 0.08);
      border-radius: 12px;
      padding: 0.9rem 1rem;
      margin: 0 0 1.25rem 0;
      color: var(--text);
    }
    .demo-warning strong { color: var(--accent); }

    /* Your global form styling covers inputs/textarea; this brings selects in line */
    .contact-form select {
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid var(--border-soft);
      border-radius: var(--radius);
      padding: 0.6rem 0.7rem;
      color: var(--text);
      font: inherit;
    }
    .contact-form select:focus {
      outline: 1px solid var(--accent);
      border-color: var(--accent);
    }

    /* Preview formatting inside a card */
    .lease-preview {
      white-space: pre-wrap;
      word-wrap: break-word;
      line-height: 1.5;
      color: var(--muted);
      margin-top: 0.75rem;
    }

    .helper-text {
      color: var(--muted);
      font-size: 0.93rem;
      margin-top: 0.35rem;
    }

    .actions-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
      margin-top: 0.5rem;
    }

    /* Make the secondary button look “site-native” without adding new global classes */
    .btn-secondary {
      display: inline-block;
      padding: 0.7rem 1.4rem;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.45);
      background: transparent;
      color: var(--text);
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      text-decoration: none;
      transition: transform var(--transition-fast), filter var(--transition-fast);
    }
    .btn-secondary:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
    }

    .tiny {
      color: var(--muted);
      font-size: 0.85rem;
      margin-top: 0.6rem;
    }

    @media print {
      .site-header, .site-footer, .actions-row, .demo-warning { display: none !important; }
      .main-content { max-width: none; padding: 0; }
      .card { box-shadow: none; }
      .lease-preview { color: #111; }
    }
  </style>
</head>

<body>
  <!-- Same header pattern as your other pages -->
  <header class="site-header" id="site-header"></header>

  <main class="main-content">
    <section class="page-header page-header-center">
      <h1>Lease Agreement Generator (Demo)</h1>
      <p>
        Interactive questionnaire + PDF output to demonstrate content implementation workflows.
      </p>
    </section>

    <div class="demo-warning">
      <strong>Demo only:</strong> This generator is for portfolio/demo purposes and is not legal advice.
      Use a lawyer for real agreements.
    </div>

    <!-- Single column: Lease details then Preview -->
    <section class="lease-grid">
      <!-- Top: Form -->
      <section class="card">
        <h2>Lease details</h2>
        <p class="helper-text">Fill this out; the preview updates instantly and can be copied/downloaded.</p>
        <br>

        <form id="leaseForm" class="contact-form">
          <label>
            Date of agreement
            <input type="date" id="date" required />
          </label>

          <label>
            Landlord name
            <input type="text" id="landlord" placeholder="e.g., Jane Smith" required />
          </label>

          <label>
            Landlord address
            <input type="text" id="landlordAddr" placeholder="Street, City, Province" required />
          </label>

          <label>
            Tenant name
            <input type="text" id="tenant" placeholder="e.g., John Doe" required />
          </label>

          <label>
            Property address
            <input type="text" id="property" placeholder="Street, City, Province" required />
          </label>

          <label>
            Monthly rent (CAD)
            <input type="number" id="rent" min="0" step="0.01" placeholder="e.g., 1500" required />
          </label>

          <label>
            Term
            <select id="term" required>
              <option value="" selected disabled>Select...</option>
              <option value="12 months fixed">12 months fixed</option>
              <option value="Month-to-month">Month-to-month</option>
            </select>
          </label>

          <label>
            Utilities included (comma-separated)
            <input type="text" id="utilities" placeholder="e.g., Water, Heat" />
          </label>

          <label>
            Security deposit (CAD)
            <input type="number" id="deposit" min="0" step="0.01" placeholder="e.g., 1500" required />
          </label>

          <label>
            Pets allowed?
            <select id="pets">
              <option value="No" selected>No</option>
              <option value="Yes, with approval">Yes, with approval</option>
            </select>
          </label>

          <div class="actions-row">
            <button class="btn-primary" id="btnPdf" type="button">Generate PDF</button>
            <button class="btn-secondary" id="btnCopy" type="button">Copy text</button>
            <button class="btn-secondary" id="btnDownload" type="button">Download .txt</button>
            <button class="btn-secondary" id="btnPrint" type="button">Print</button>
            <button class="btn-secondary" id="btnSample" type="button">Fill sample</button>
            <button class="btn-secondary" id="btnReset" type="button">Reset</button>
          </div>

          <div class="tiny" id="status" aria-live="polite"></div>
        </form>
      </section>

      <!-- Bottom: Preview -->
      <section class="card">
        <h2>Preview</h2>
        <p class="helper-text">
          This preview updates as you type (and auto-saves in your browser).
        </p>
        <pre id="preview" class="lease-preview">Fill in the form to see a preview here.</pre>
        <div class="tiny">Auto-saves in your browser (localStorage).</div>
      </section>
    </section>
  </main>

  <!-- Same footer pattern as your other pages -->
  <footer class="site-footer" id="site-footer"></footer>

  <script src="footer.js"></script>
  <script src="header.js"></script>

  <script>
    const els = {
      form: document.getElementById("leaseForm"),
      preview: document.getElementById("preview"),
      status: document.getElementById("status"),

      date: document.getElementById("date"),
      landlord: document.getElementById("landlord"),
      landlordAddr: document.getElementById("landlordAddr"),
      tenant: document.getElementById("tenant"),
      property: document.getElementById("property"),
      rent: document.getElementById("rent"),
      term: document.getElementById("term"),
      utilities: document.getElementById("utilities"),
      deposit: document.getElementById("deposit"),
      pets: document.getElementById("pets"),

      btnPdf: document.getElementById("btnPdf"),
      btnCopy: document.getElementById("btnCopy"),
      btnDownload: document.getElementById("btnDownload"),
      btnPrint: document.getElementById("btnPrint"),
      btnSample: document.getElementById("btnSample"),
      btnReset: document.getElementById("btnReset"),
    };

    const STORAGE_KEY = "leaseAgreementDraft_v1";
    let statusTimerId = null;

    function nowISODate() {
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${y}-${m}-${day}`;
    }

    function setStatus(msg) {
      els.status.textContent = msg || "";
      if (!msg) return;

      if (statusTimerId) window.clearTimeout(statusTimerId);
      statusTimerId = window.setTimeout(() => (els.status.textContent = ""), 2500);
    }

    function getState() {
      return {
        date: els.date.value || "",
        landlord: els.landlord.value.trim(),
        landlordAddr: els.landlordAddr.value.trim(),
        tenant: els.tenant.value.trim(),
        property: els.property.value.trim(),
        rent: els.rent.value,
        term: els.term.value,
        utilities: (els.utilities.value || "").trim(),
        deposit: els.deposit.value,
        pets: els.pets.value
      };
    }

    function setState(s) {
      els.date.value = s.date ?? "";
      els.landlord.value = s.landlord ?? "";
      els.landlordAddr.value = s.landlordAddr ?? "";
      els.tenant.value = s.tenant ?? "";
      els.property.value = s.property ?? "";
      els.rent.value = s.rent ?? "";
      els.term.value = s.term ?? "";
      els.utilities.value = s.utilities ?? "";
      els.deposit.value = s.deposit ?? "";
      els.pets.value = s.pets ?? "No";
    }

    function saveDraft() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(getState()));
      } catch (_) {}
    }

    function loadDraft() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return false;
        setState(JSON.parse(raw));
        return true;
      } catch (_) {
        return false;
      }
    }

    function lineIf(val, placeholder) {
      const t = (val || "").trim();
      return t ? t : (placeholder || "[Enter value]");
    }

    function money(val) {
      if (val === null || val === undefined || val === "") return "[Enter amount]";
      const n = Number(val);
      if (Number.isNaN(n)) return "[Enter amount]";
      return n.toFixed(2);
    }

    function buildPreviewText(s) {
      const date = s.date || "[Date]";
      const landlord = lineIf(s.landlord, "[Landlord]");
      const landlordAddr = lineIf(s.landlordAddr, "[Landlord address]");
      const tenant = lineIf(s.tenant, "[Tenant]");
      const property = lineIf(s.property, "[Property address]");
      const rent = money(s.rent);
      const term = s.term || "[Term]";
      const utilities = s.utilities ? s.utilities : "None";
      const deposit = money(s.deposit);
      const pets = s.pets || "No";

      return (
`RESIDENTIAL TENANCY AGREEMENT (Demo)

Date: ${date}

Landlord: ${landlord}
Landlord Address: ${landlordAddr}

Tenant: ${tenant}

Property: ${property}

Rent: $${rent}/month
Term: ${term}
Utilities Included: ${utilities}
Security Deposit: $${deposit}
Pets: ${pets}

Demo only. Not legal advice.`
      );
    }

    function update() {
      const s = getState();
      els.preview.textContent = buildPreviewText(s);
      saveDraft();
    }

    function generatePdfFromPreview() {
      const text = els.preview.textContent || "";
      if (!text.trim()) {
        setStatus("Nothing to export yet.");
        return;
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(16);
      doc.text("Residential Tenancy Agreement (Demo)", 14, 18);

      doc.setFontSize(11);
      const marginX = 14;
      const startY = 28;
      const lineHeight = 6;

      const pageHeight = doc.internal.pageSize.getHeight();
      const maxWidth = doc.internal.pageSize.getWidth() - marginX * 2;

      const lines = doc.splitTextToSize(text, maxWidth);
      let y = startY;

      for (let i = 0; i < lines.length; i++) {
        if (y > pageHeight - 14) {
          doc.addPage();
          y = 18;
        }
        doc.text(lines[i], marginX, y);
        y += lineHeight;
      }

      doc.save("lease-agreement-demo.pdf");
      setStatus("PDF generated.");
    }

    // Bind live updates like your other generators
    const inputEls = Array.from(els.form.querySelectorAll("input, select, textarea"));
    inputEls.forEach(el => el.addEventListener("input", update));
    inputEls.forEach(el => el.addEventListener("change", update));

    els.btnPdf.addEventListener("click", generatePdfFromPreview);

    els.btnCopy.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(els.preview.textContent || "");
        setStatus("Copied to clipboard.");
      } catch (e) {
        setStatus("Copy failed (browser permissions).");
      }
    });

    els.btnDownload.addEventListener("click", () => {
      const blob = new Blob([els.preview.textContent || ""], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "lease-agreement-demo.txt";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      setStatus("Downloaded lease-agreement-demo.txt");
    });

    els.btnPrint.addEventListener("click", () => window.print());

    els.btnSample.addEventListener("click", () => {
      setState({
        date: nowISODate(),
        landlord: "Jane Smith",
        landlordAddr: "Edmonton, Alberta, Canada",
        tenant: "John Doe",
        property: "Sherwood Park, Alberta, Canada",
        rent: "1500",
        term: "12 months fixed",
        utilities: "Water, Heat",
        deposit: "1500",
        pets: "No"
      });
      update();
      setStatus("Sample filled.");
    });

    els.btnReset.addEventListener("click", () => {
      localStorage.removeItem(STORAGE_KEY);
      setState({
        date: "",
        landlord: "",
        landlordAddr: "",
        tenant: "",
        property: "",
        rent: "",
        term: "",
        utilities: "",
        deposit: "",
        pets: "No"
      });

      // Default date like your original demo
      els.date.valueAsDate = new Date();
      update();
      setStatus("Reset.");
    });

    // Init
    if (!loadDraft()) {
      els.date.valueAsDate = new Date();
    }
    update();

    // Prevent accidental form submit reload
    els.form.addEventListener("submit", (e) => e.preventDefault());
  </script>
</body>
</html>
